import{aH as _e,u as Ie,ae as Ve,h as se,aI as B,n as Ae,e as j,aJ as de,aK as Oe,aL as Ee,E as De,aM as ke,_ as le,aN as Be,N as R,O as Q,x as re,G as fe,H as Re,W as Ge,V as Ue,T as $e,Q as Fe,aO as ze,aP as Xe,aQ as Ye,aR as He,y as we,J as qe,M as We,p as Ze,g as Je,aS as pe,d as Le,aT as je,aU as Qe,aV as Ke,A as et,aW as tt,aX as at,aA as rt,ax as nt,aB as it,aC as st,aD as lt,aE as ot,aF as gt,aG as ct}from"./ChartCtrl-26bb07cb.js";import{j as vt,A as ut,_ as ht,o as dt,c as ft,w as me,r as ne,b as ye,d as pt,q as mt}from"./index-172ad7fb.js";var be=Math.PI*2,K=Math.PI/180;function xe(a,t){return Ve(a.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function Ne(a,t){var r=xe(a,t),e=a.get("center"),i=a.get("radius");se(i)||(i=[0,i]);var l=B(r.width,t.getWidth()),n=B(r.height,t.getHeight()),g=Math.min(l,n),v=B(i[0],g/2),f=B(i[1],g/2),c,p,u=a.coordinateSystem;if(u){var s=u.dataToPoint(e);c=s[0]||0,p=s[1]||0}else se(e)||(e=[e,e]),c=B(e[0],l)+r.x,p=B(e[1],n)+r.y;return{cx:c,cy:p,r0:v,r:f}}function yt(a,t,r){t.eachSeriesByType(a,function(e){var i=e.getData(),l=i.mapDimension("value"),n=xe(e,r),g=Ne(e,r),v=g.cx,f=g.cy,c=g.r,p=g.r0,u=-e.get("startAngle")*K,s=e.get("endAngle"),o=e.get("padAngle")*K;s=s==="auto"?u-be:-s*K;var h=e.get("minAngle")*K,d=h+o,y=0;i.each(l,function(V){!isNaN(V)&&y++});var S=i.getSum(l),b=Math.PI/(S||y)*2,x=e.get("clockwise"),w=e.get("roseType"),N=e.get("stillShowZeroSum"),M=i.getDataExtent(l);M[0]=0;var m=x?1:-1,A=[u,s],_=m*o/2;_e(A,!x),u=A[0],s=A[1];var G=Te(e);G.startAngle=u,G.endAngle=s,G.clockwise=x;var E=Math.abs(s-u),O=E,$=0,I=u;if(i.setLayout({viewRect:n,r:c}),i.each(l,function(V,C){var D;if(isNaN(V)){i.setItemLayout(C,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:x,cx:v,cy:f,r0:p,r:w?NaN:c});return}w!=="area"?D=S===0&&N?b:V*b:D=E/y,D<d?(D=d,O-=d):$+=V;var P=I+m*D,T=0,L=0;o>D?(T=I+m*D/2,L=T):(T=I+_,L=P-_),i.setItemLayout(C,{angle:D,startAngle:T,endAngle:L,clockwise:x,cx:v,cy:f,r0:p,r:w?Ie(V,M,[p,c]):c}),I=P}),O<be&&y)if(O<=.001){var k=E/y;i.each(l,function(V,C){if(!isNaN(V)){var D=i.getItemLayout(C);D.angle=k;var P=0,T=0;k<o?(P=u+m*(C+1/2)*k,T=P):(P=u+m*C*k+_,T=u+m*(C+1)*k-_),D.startAngle=P,D.endAngle=T}})}else b=O/$,I=u,i.each(l,function(V,C){if(!isNaN(V)){var D=i.getItemLayout(C),P=D.angle===d?d:V*b,T=0,L=0;P<o?(T=I+m*P/2,L=T):(T=I+_,L=I+m*P-_),D.startAngle=T,D.endAngle=L,I+=m*P}})})}var Te=Ae();function bt(a){return{seriesType:a,reset:function(t,r){var e=r.findComponents({mainType:"legend"});if(!(!e||!e.length)){var i=t.getData();i.filterSelf(function(l){for(var n=i.getName(l),g=0;g<e.length;g++)if(!e[g].isSelected(n))return!1;return!0})}}}}var St=Math.PI/180;function Se(a,t,r,e,i,l,n,g,v,f){if(a.length<2)return;function c(h){for(var d=h.rB,y=d*d,S=0;S<h.list.length;S++){var b=h.list[S],x=Math.abs(b.label.y-r),w=e+b.len,N=w*w,M=Math.sqrt((1-Math.abs(x*x/y))*N),m=t+(M+b.len2)*i,A=m-b.label.x,_=b.targetTextWidth-A*i;Pe(b,_,!0),b.label.x=m}}function p(h){for(var d={list:[],maxY:0},y={list:[],maxY:0},S=0;S<h.length;S++)if(h[S].labelAlignTo==="none"){var b=h[S],x=b.label.y>r?y:d,w=Math.abs(b.label.y-r);if(w>=x.maxY){var N=b.label.x-t-b.len2*i,M=e+b.len,m=Math.abs(N)<M?Math.sqrt(w*w/(1-N*N/M/M)):M;x.rB=m,x.maxY=w}x.list.push(b)}c(d),c(y)}for(var u=a.length,s=0;s<u;s++)if(a[s].position==="outer"&&a[s].labelAlignTo==="labelLine"){var o=a[s].label.x-f;a[s].linePoints[1][0]+=o,a[s].label.x=f}ke(a,v,v+n)&&p(a)}function At(a,t,r,e,i,l,n,g){for(var v=[],f=[],c=Number.MAX_VALUE,p=-Number.MAX_VALUE,u=0;u<a.length;u++){var s=a[u].label;ie(a[u])||(s.x<t?(c=Math.min(c,s.x),v.push(a[u])):(p=Math.max(p,s.x),f.push(a[u])))}for(var u=0;u<a.length;u++){var o=a[u];if(!ie(o)&&o.linePoints){if(o.labelStyleWidth!=null)continue;var s=o.label,h=o.linePoints,d=void 0;o.labelAlignTo==="edge"?s.x<t?d=h[2][0]-o.labelDistance-n-o.edgeDistance:d=n+i-o.edgeDistance-h[2][0]-o.labelDistance:o.labelAlignTo==="labelLine"?s.x<t?d=c-n-o.bleedMargin:d=n+i-p-o.bleedMargin:s.x<t?d=s.x-n-o.bleedMargin:d=n+i-s.x-o.bleedMargin,o.targetTextWidth=d,Pe(o,d)}}Se(f,t,r,e,1,i,l,n,g,p),Se(v,t,r,e,-1,i,l,n,g,c);for(var u=0;u<a.length;u++){var o=a[u];if(!ie(o)&&o.linePoints){var s=o.label,h=o.linePoints,y=o.labelAlignTo==="edge",S=s.style.padding,b=S?S[1]+S[3]:0,x=s.style.backgroundColor?0:b,w=o.rect.width+x,N=h[1][0]-h[2][0];y?s.x<t?h[2][0]=n+o.edgeDistance+w+o.labelDistance:h[2][0]=n+i-o.edgeDistance-w-o.labelDistance:(s.x<t?h[2][0]=s.x+o.labelDistance:h[2][0]=s.x-o.labelDistance,h[1][0]=h[2][0]+N),h[1][1]=h[2][1]=s.y}}}function Pe(a,t,r){if(r===void 0&&(r=!1),a.labelStyleWidth==null){var e=a.label,i=e.style,l=a.rect,n=i.backgroundColor,g=i.padding,v=g?g[1]+g[3]:0,f=i.overflow,c=l.width+(n?0:v);if(t<c||r){var p=l.height;if(f&&f.match("break")){e.setStyle("backgroundColor",null),e.setStyle("width",t-v);var u=e.getBoundingRect();e.setStyle("width",Math.ceil(u.width)),e.setStyle("backgroundColor",n)}else{var s=t-v,o=t<c?s:r?s>a.unconstrainedWidth?null:s:null;e.setStyle("width",o)}var h=e.getBoundingRect();l.width=h.width;var d=(e.style.margin||0)+2.1;l.height=h.height+d,l.y-=(l.height-p)/2}}}function ie(a){return a.position==="center"}function Dt(a){var t=a.getData(),r=[],e,i,l=!1,n=(a.get("minShowLabelAngle")||0)*St,g=t.getLayout("viewRect"),v=t.getLayout("r"),f=g.width,c=g.x,p=g.y,u=g.height;function s(N){N.ignore=!0}function o(N){if(!N.ignore)return!0;for(var M in N.states)if(N.states[M].ignore===!1)return!0;return!1}t.each(function(N){var M=t.getItemGraphicEl(N),m=M.shape,A=M.getTextContent(),_=M.getTextGuideLine(),G=t.getItemModel(N),E=G.getModel("label"),O=E.get("position")||G.get(["emphasis","label","position"]),$=E.get("distanceToLabelLine"),I=E.get("alignTo"),k=B(E.get("edgeDistance"),f),V=E.get("bleedMargin"),C=G.getModel("labelLine"),D=C.get("length");D=B(D,f);var P=C.get("length2");if(P=B(P,f),Math.abs(m.endAngle-m.startAngle)<n){j(A.states,s),A.ignore=!0,_&&(j(_.states,s),_.ignore=!0);return}if(o(A)){var T=(m.startAngle+m.endAngle)/2,L=Math.cos(T),U=Math.sin(T),Y,Z,oe,J;e=m.cx,i=m.cy;var F=O==="inside"||O==="inner";if(O==="center")Y=m.cx,Z=m.cy,J="center";else{var ee=(F?(m.r+m.r0)/2*L:m.r*L)+e,te=(F?(m.r+m.r0)/2*U:m.r*U)+i;if(Y=ee+L*3,Z=te+U*3,!F){var ge=ee+L*(D+v-m.r),ce=te+U*(D+v-m.r),ve=ge+(L<0?-1:1)*P,ue=ce;I==="edge"?Y=L<0?c+k:c+f-k:Y=ve+(L<0?-$:$),Z=ue,oe=[[ee,te],[ge,ce],[ve,ue]]}J=F?"center":I==="edge"?L>0?"right":"left":L>0?"left":"right"}var H=Math.PI,z=0,q=E.get("rotate");if(De(q))z=q*(H/180);else if(O==="center")z=0;else if(q==="radial"||q===!0){var Me=L<0?-T+H:-T;z=Me}else if(q==="tangential"&&O!=="outside"&&O!=="outer"){var X=Math.atan2(L,U);X<0&&(X=H*2+X);var Ce=U>0;Ce&&(X=H+X),z=X-H}if(l=!!z,A.x=Y,A.y=Z,A.rotation=z,A.setStyle({verticalAlign:"middle"}),F){A.setStyle({align:J});var ae=A.states.select;ae&&(ae.x+=A.x,ae.y+=A.y)}else{var W=A.getBoundingRect().clone();W.applyTransform(A.getComputedTransform());var he=(A.style.margin||0)+2.1;W.y-=he/2,W.height+=he,r.push({label:A,labelLine:_,position:O,len:D,len2:P,minTurnAngle:C.get("minTurnAngle"),maxSurfaceAngle:C.get("maxSurfaceAngle"),surfaceNormal:new de(L,U),linePoints:oe,textAlign:J,labelDistance:$,labelAlignTo:I,edgeDistance:k,bleedMargin:V,rect:W,unconstrainedWidth:W.width,labelStyleWidth:A.style.width})}M.setTextConfig({inside:F})}}),!l&&a.get("avoidLabelOverlap")&&At(r,e,i,v,f,u,c,p);for(var h=0;h<r.length;h++){var d=r[h],y=d.label,S=d.labelLine,b=isNaN(y.x)||isNaN(y.y);if(y){y.setStyle({align:d.textAlign}),b&&(j(y.states,s),y.ignore=!0);var x=y.states.select;x&&(x.x+=y.x,x.y+=y.y)}if(S){var w=d.linePoints;b||!w?(j(S.states,s),S.ignore=!0):(Oe(w,d.minTurnAngle),Ee(w,d.surfaceNormal,d.maxSurfaceAngle),S.setShape({points:w}),y.__hostTarget.textGuideLineConfig={anchor:new de(w[0][0],w[0][1])})}}}var wt=function(a){le(t,a);function t(r,e,i){var l=a.call(this)||this;l.z2=2;var n=new Be;return l.setTextContent(n),l.updateData(r,e,i,!0),l}return t.prototype.updateData=function(r,e,i,l){var n=this,g=r.hostModel,v=r.getItemModel(e),f=v.getModel("emphasis"),c=r.getItemLayout(e),p=R(Q(v.getModel("itemStyle"),c,!0),c);if(isNaN(p.startAngle)){n.setShape(p);return}if(l){n.setShape(p);var u=g.getShallow("animationType");g.ecModel.ssr?(re(n,{scaleX:0,scaleY:0},g,{dataIndex:e,isFrom:!0}),n.originX=p.cx,n.originY=p.cy):u==="scale"?(n.shape.r=c.r0,re(n,{shape:{r:c.r}},g,e)):i!=null?(n.setShape({startAngle:i,endAngle:i}),re(n,{shape:{startAngle:c.startAngle,endAngle:c.endAngle}},g,e)):(n.shape.endAngle=c.startAngle,fe(n,{shape:{endAngle:c.endAngle}},g,e))}else Re(n),fe(n,{shape:p},g,e);n.useStyle(r.getItemVisual(e,"style")),Ge(n,v);var s=(c.startAngle+c.endAngle)/2,o=g.get("selectedOffset"),h=Math.cos(s)*o,d=Math.sin(s)*o,y=v.getShallow("cursor");y&&n.attr("cursor",y),this._updateLabel(g,r,e),n.ensureState("emphasis").shape=R({r:c.r+(f.get("scale")&&f.get("scaleSize")||0)},Q(f.getModel("itemStyle"),c)),R(n.ensureState("select"),{x:h,y:d,shape:Q(v.getModel(["select","itemStyle"]),c)}),R(n.ensureState("blur"),{shape:Q(v.getModel(["blur","itemStyle"]),c)});var S=n.getTextGuideLine(),b=n.getTextContent();S&&R(S.ensureState("select"),{x:h,y:d}),R(b.ensureState("select"),{x:h,y:d}),Ue(this,f.get("focus"),f.get("blurScope"),f.get("disabled"))},t.prototype._updateLabel=function(r,e,i){var l=this,n=e.getItemModel(i),g=n.getModel("labelLine"),v=e.getItemVisual(i,"style"),f=v&&v.fill,c=v&&v.opacity;$e(l,Fe(n),{labelFetcher:e.hostModel,labelDataIndex:i,inheritColor:f,defaultOpacity:c,defaultText:r.getFormattedLabel(i,"normal")||e.getName(i)});var p=l.getTextContent();l.setTextConfig({position:null,rotation:null}),p.attr({z2:10});var u=r.get(["label","position"]);if(u!=="outside"&&u!=="outer")l.removeTextGuideLine();else{var s=this.getTextGuideLine();s||(s=new ze,this.setTextGuideLine(s)),Xe(this,He(n),{stroke:f,opacity:Ye(g.get(["lineStyle","opacity"]),c,1)})}},t}(we),Lt=function(a){le(t,a);function t(){var r=a!==null&&a.apply(this,arguments)||this;return r.ignoreLabelLineUpdate=!0,r}return t.prototype.render=function(r,e,i,l){var n=r.getData(),g=this._data,v=this.group,f;if(!g&&n.count()>0){for(var c=n.getItemLayout(0),p=1;isNaN(c&&c.startAngle)&&p<n.count();++p)c=n.getItemLayout(p);c&&(f=c.startAngle)}if(this._emptyCircleSector&&v.remove(this._emptyCircleSector),n.count()===0&&r.get("showEmptyCircle")){var u=Te(r),s=new we({shape:R(Ne(r,i),u)});s.useStyle(r.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=s,v.add(s)}n.diff(g).add(function(o){var h=new wt(n,o,f);n.setItemGraphicEl(o,h),v.add(h)}).update(function(o,h){var d=g.getItemGraphicEl(h);d.updateData(n,o,f),d.off("click"),v.add(d),n.setItemGraphicEl(o,d)}).remove(function(o){var h=g.getItemGraphicEl(o);qe(h,r,o)}).execute(),Dt(r),r.get("animationTypeUpdate")!=="expansion"&&(this._data=n)},t.prototype.dispose=function(){},t.prototype.containPoint=function(r,e){var i=e.getData(),l=i.getItemLayout(0);if(l){var n=r[0]-l.cx,g=r[1]-l.cy,v=Math.sqrt(n*n+g*g);return v<=l.r&&v>=l.r0}},t.type="pie",t}(We);const xt=Lt;function Nt(a,t,r){t=se(t)&&{coordDimensions:t}||R({encodeDefine:a.getEncode()},t);var e=a.getSource(),i=Ze(e,t).dimensions,l=new Je(i,a);return l.initData(e,r),l}var Tt=function(){function a(t,r){this._getDataWithEncodedVisual=t,this._getRawData=r}return a.prototype.getAllNames=function(){var t=this._getRawData();return t.mapArray(t.getName)},a.prototype.containName=function(t){var r=this._getRawData();return r.indexOfName(t)>=0},a.prototype.indexOfName=function(t){var r=this._getDataWithEncodedVisual();return r.indexOfName(t)},a.prototype.getItemVisual=function(t,r){var e=this._getDataWithEncodedVisual();return e.getItemVisual(t,r)},a}();const Pt=Tt;var Mt=Ae(),Ct=function(a){le(t,a);function t(){return a!==null&&a.apply(this,arguments)||this}return t.prototype.init=function(r){a.prototype.init.apply(this,arguments),this.legendVisualProvider=new Pt(pe(this.getData,this),pe(this.getRawData,this)),this._defaultLabelLine(r)},t.prototype.mergeOption=function(){a.prototype.mergeOption.apply(this,arguments)},t.prototype.getInitialData=function(){return Nt(this,{coordDimensions:["value"],encodeDefaulter:Le(je,this)})},t.prototype.getDataParams=function(r){var e=this.getData(),i=Mt(e),l=i.seats;if(!l){var n=[];e.each(e.mapDimension("value"),function(v){n.push(v)}),l=i.seats=Qe(n,e.hostModel.get("percentPrecision"))}var g=a.prototype.getDataParams.call(this,r);return g.percent=l[r]||0,g.$vars.push("percent"),g},t.prototype._defaultLabelLine=function(r){Ke(r,"labelLine",["show"]);var e=r.labelLine,i=r.emphasis.labelLine;e.show=e.show&&r.label.show,i.show=i.show&&r.emphasis.label.show},t.type="series.pie",t.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,endAngle:"auto",padAngle:0,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},t}(et);const _t=Ct;function It(a){return{seriesType:a,reset:function(t,r){var e=t.getData();e.filterSelf(function(i){var l=e.mapDimension("value"),n=e.get(l,i);return!(De(n)&&!isNaN(n)&&n<0)})}}}function Vt(a){a.registerChartView(xt),a.registerSeriesModel(_t),tt("pie",a.registerAction),a.registerLayout(Le(yt,"pie")),a.registerProcessor(bt("pie")),a.registerProcessor(It("pie"))}nt([Vt,it,st,lt,ot,gt,ct]);const Ot={name:"ScoreTagsChart",data(){return{scores:[0,10],chart_option:{series:[{type:"pie",data:[]}]}}},methods:{...vt(ut,{getTagName:"getName"}),async onScoreChange(){const[a,t]=await at(this.scores[0],this.scores[1]);a&&this.refreshChart(t)},refreshChart(a){const t=[];for(const e of a){const i=this.getTagName(e.tag_id);t.push({name:i,value:e.count})}this.chart_option.series[0].data=t,rt(document.getElementById("score_tags")).setOption(this.chart_option)},mounted(){}}},Et=mt("div",{id:"score_tags",style:{width:"640px",height:"640px"}},null,-1);function kt(a,t,r,e,i,l){const n=ne("el-text"),g=ne("el-slider"),v=ne("el-space");return dt(),ft(v,{direction:"vertical",alignment:"flex-start"},{default:me(()=>[ye(n,{style:{"font-size":"24px"}},{default:me(()=>[pt(" Choose Score Range ")]),_:1}),ye(g,{modelValue:i.scores,"onUpdate:modelValue":t[0]||(t[0]=f=>i.scores=f),min:0,max:10,range:"","show-stops":"",style:{width:"400px"},onChange:l.onScoreChange},null,8,["modelValue","onChange"]),Et]),_:1})}const Gt=ht(Ot,[["render",kt]]);export{Gt as default};
